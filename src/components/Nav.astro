---
import wapa from "../images/logotipo.png";
import wapablack from "../images/logotipo-black.png";

export interface Props {
    lightColor?: boolean;
}

const homePages = ["/", "/lista-de-precios"];
const isHomePage = homePages.includes(Astro.url.pathname);
---

<style>
    #closeButton {
        display: none;
    }

    #contenedor {
        height: 100vh;
        min-height: 100dvh;
        display: none;
        opacity: 0;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: fixed;
        inset: 0;
        z-index: 50;
        background: rgba(254, 248, 242, 0.95);
        transition: all ease-in-out 300ms !important;
    }
    #contenedor.view {
        display: flex !important;
        opacity: 1 !important;
    }
    .view {
        opacity: 1 !important;
    }
</style>
<script>
    window.addEventListener("DOMContentLoaded", function () {
        const burgerButton = document.getElementById("burgerButton");
        const closeButton = document.getElementById("closeButton");
        const button = document.getElementById("buttonBurger");
        const contenedor = document.getElementById("contenedor");

        function toggleMenu() {
            if (!contenedor.classList.contains("view")) {
                contenedor.classList.add("view");
                closeButton.style.display = "block";
                burgerButton.style.display = "none";
            } else {
                contenedor.classList.remove("view");
                closeButton.style.display = "none";
                burgerButton.style.display = "block";
            }
        }

        button.addEventListener("click", toggleMenu);
        closeButton.addEventListener("click", toggleMenu);

        // Elimina la lógica de supabase/logout, solo navega al link
        const logoutLink = document.getElementById("logout-link");
        logoutLink?.addEventListener("click", function (e) {
            // Permite la navegación normal del enlace
        });
    });
</script>

<nav
    class={`md:flex hidden md:justify-between md:items-center md:px-8 lg:px-20 w-full my-2 ${
        isHomePage ? "mx-auto absolute" : "bg-transparent backdrop-blur-md"
    }`}
>
    <div>
        <a href="/">
            <img
                class="w-32"
                src={Astro.props.lightColor ? wapablack.src : wapa.src}
                alt="Logotipo de wapa"
            />
        </a>
    </div>
    <div class="flex w-full items-center">
        <div
            class:list={[
                "flex space-x-8 my-4 flex-1 justify-end",
                Astro.props.lightColor ? "text-black" : "text-white",
            ]}
        >
            <a
                class:list={[
                    Astro.props.lightColor
                        ? "hover:text-yellow-600 focus:text-yellow-600"
                        : "hover:text-yellow-600 focus:text-yellow-600",
                ]}
                href="/blog"
                aria-label="Blog"
            >
                <h3>Blog</h3>
            </a>
            <a
                class:list={[
                    Astro.props.lightColor
                        ? "hover:text-yellow-600 focus:text-yellow-600"
                        : "hover:text-yellow-600 focus:text-yellow-600",
                ]}
                href="/asesoria"
                aria-label="Asesoria"
            >
                <h3>Asesoría</h3>
            </a>
            <div class="h-6 w-[2px] bg-gray-200"></div>
            <a
                href="/signin"
                aria-label="Iniciar sesión"
                class="font-medium hover:text-yellow-600 transition-colors duration-200 text-gray-700 bg-white"
                style="margin-left:2rem;"
            >
                Iniciar sesión
            </a>
        </div>
    </div>
</nav>

<nav
    class={`flex justify-between px-4
    ${isHomePage ? "md:mx-auto absolute md:hidden w-full px-3 py-3" : "reltive md:hidden bg-transparent px-3 py-3"}`}
>
    <div class="relative flex justify-between w-full">
        <div>
            <a href="/">
                <img
                    class="w-24"
                    src={Astro.props.lightColor ? wapablack.src : wapa.src}
                    alt="Logotipo de wapa"
                />
            </a>
        </div>
        <div class="flex flex-col my-auto text-white">
            <button
                class="flex flex-col items-end"
                id="buttonBurger"
                type="button"
            >
                <svg
                    aria-label="Abrir menú"
                    class:list={[
                        "w-5",
                        Astro.props.lightColor ? "fill-black" : "fill-white",
                    ]}
                    id="burgerButton"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 448 512"
                >
                    <path
                        d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"
                    ></path>
                </svg>
            </button>
            <div
                class="absolute inset-0 top-16 flex items-center justify-center w-full bg-[#fef8f2]/95 backdrop-blur-sm"
                id="contenedor"
            >
                <button
                    id="closeButton"
                    aria-label="Cerrar menú"
                    class="absolute top-4 right-4 z-50 bg-white/80 rounded-full p-2 shadow"
                    style="display: none;"
                >
                    <svg
                        class:list={[
                            "w-6 h-6",
                            Astro.props.lightColor
                                ? "fill-black"
                                : "fill-slate-700",
                        ]}
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 384 512"
                    >
                        <path
                            d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"
                        ></path>
                    </svg>
                </button>
                <div
                    class="wrapper flex flex-col justify-center space-y-6 items-center w-full p-4 text-black"
                    id="wrapper"
                >
                    <a
                        class="hover:text-yellow-600 focus:text-yellow-600 text-center text-xl"
                        href="/signin"
                        aria-label="Iniciar sesión"
                    >
                        Iniciar sesión
                    </a>
                    <a
                        class="hover:text-yellow-600 focus:text-yellow-600 text-center text-xl"
                        href="/blog"
                        aria-label="Blog"
                    >
                        <h3>Blog</h3>
                    </a>
                    <a
                        class="hover:text-yellow-600 focus:text-yellow-600 text-center text-xl"
                        href="/asesoria"
                        aria-label="Asesoria"
                    >
                        <h3>Asesoría</h3>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>
